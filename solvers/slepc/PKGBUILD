# Maintainer: Myles English <myles at rockhead dot biz>
pkgname=slepc
pkgver=3.1_p4
_config=linux-gnu-cxx-debug
pkgrel=1
pkgdesc="Scalable library for Eigenvalue problem computations"
arch=('i686' 'x86_64')
url="http://www.grycap.upv.es/slepc"
license=('GNUv3')
depends=('python2' 'gcc' 'petsc')
install=slepc.install
source=(http://www.grycap.upv.es/slepc/download/distrib/${pkgname}-${pkgver/_/-}.tgz)
md5sums=('96057d4ee9d1a17c7b1aa614d864f84a')

build() {
    local _build_dir=${srcdir}/${pkgname}-${pkgver/_/-}
    local _install_dir=/usr/lib/slepc/${_config}
    cd ${_build_dir}

    unset PETSC_ARCH   
    export SLEPC_DIR=${_build_dir}

    python2 ./configure --prefix=${pkgdir}${_install_dir} || return 1

    export PETSC_ARCH=installed-petsc

    make || return 1
    make install  || return 1

    export SLEPC_DIR=${_install_dir}
    unset PETSC_ARCH

    sed -i 's#'"${pkgdir}"'##g' "${pkgdir}${_install_dir}/conf/slepcvariables"
}
