# Maintainer: Myles English <myles at rockhead dot biz>
pkgname=slepc
pkgver=3.1_p4
_config=linux-gnu-cxx-debug
pkgrel=1
pkgdesc="Scalable library for Eigenvalue problem computations"
arch=('i686' 'x86_64')
url="http://www.grycap.upv.es/slepc"
license=('GNUv3')
depends=('python2' 'gcc' 'petsc')
install=slepc.install
source=(http://www.grycap.upv.es/slepc/download/distrib/${pkgname}-${pkgver/_/-}.tgz)
md5sums=('96057d4ee9d1a17c7b1aa614d864f84a')
build() {
   cd ${srcdir}/${pkgname}-${pkgver/_/-}

   export PETSC_DIR=/usr/${_config}
   unset PETSC_ARCH
   export PETSC_ARCH=${_config}
   unset SLEPC_DIR
   export SLEPC_DIR=${srcdir}/${pkgname}-${pkgver/_/-}

   python2 ./configure --prefix=${pkgdir}/usr/${_config} || return 1

   make || return 1
   make install  || return 1
   #unset PETSC_ARCH
   sed -i "s#${pkgdir}##g" "${pkgdir}/usr/${_config}/conf/slepcvariables"
   # file conflicts with petsc:
   #/usr/${_config}/include/finclude/index.html
   #/usr/${_config}/include/finclude/makefile.html

   # mkdir -p
   #${pkgdir}/etc/ld.so.conf.d echo "/usr/lib/${pkgname}" >
   #${pkgdir}/etc/ld.so.conf.d/${pkgname}.conf}
}
